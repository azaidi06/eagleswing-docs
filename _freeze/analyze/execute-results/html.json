{
  "hash": "014215e0fd7cb5a8f5322f08634e872b",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Biomechanical Analysis\"\nsubtitle: \"Swing comparison, metrics, and statistical analysis\"\n---\n\n## Overview\n\nTakes keypoint pkl files + detection results and produces:\n\n- **Swing-by-swing metric extraction** — shoulder turn, hip rotation, X-factor, spine angle, etc.\n- **Statistical comparison** — SPM (Statistical Parametric Mapping) between swing groups\n- **Medoid selection** — most representative swing from a set\n- **Visualization** — overlay plots, metric time series, comparison grids\n\n## Entry Points\n\n```bash\n# CLI pipeline (headless)\npython -m analyze.pipeline --golfer stef --no-gemini --no-pushover\n\n# With day filter and phase selection\npython -m analyze.pipeline --golfer ymirza --day oct25 --phases backswing downswing\n\n# Streamlit dashboard\nstreamlit run analyze/new_dashboard.py\n```\n\n## Core Data Structure\n\n::: {#de39deb8 .cell execution_count=1}\n``` {.python .cell-code}\nfrom dataclasses import dataclass\nimport numpy as np\n\n@dataclass\nclass SwingData:\n    name: str                       # Video/swing identifier\n    keypoints: np.ndarray           # (phase_frames, 17, 2) — normalized\n    keypoint_scores: np.ndarray     # (phase_frames, 17) — confidence\n    fps: float                      # Frame rate\n```\n:::\n\n\nSwings are aligned by phase (backswing, downswing) and time-normalized for comparison.\n\n## Metrics Computed\n\n::: {#70e35503 .cell execution_count=2}\n\n::: {.cell-output .cell-output-stdout}\n```\n\nRotation:\n  - Shoulder Turn\n  - Hip Turn\n  - X-Factor\n  - X-Factor Stretch\n\nPosture:\n  - Spine Angle\n  - Shoulder Tilt\n  - Forward Bend\n\nLinear:\n  - Hip Sway\n  - Head Height\n  - Weight Shift\n```\n:::\n:::\n\n\nEach metric is computed per-frame across a swing phase, producing time series that can be compared statistically.\n\n## Analysis Pipeline Flow\n\n```{mermaid}\nflowchart TD\n    CSV[\"CSV index<br/>(golfer, day, pkls)\"] --> Load[\"Load pkl + detection<br/>per swing\"]\n    Load --> Phase[\"Phase extraction<br/>(backswing / downswing)\"]\n    Phase --> Norm[\"Time normalization<br/>(0-100% of phase)\"]\n    Norm --> Metrics[\"Metric computation<br/>(rotation, posture, linear)\"]\n    Metrics --> Medoid[\"Medoid selection<br/>(most representative swing)\"]\n    Metrics --> SPM[\"SPM t-test<br/>(group comparison)\"]\n    Medoid --> Plot[\"render_analysis_figure()\"]\n    SPM --> Plot\n    Plot --> S3[\"Upload to S3 /analysis/\"]\n    Plot --> Push[\"Pushover notification\"]\n```\n\n## Key Functions\n\n::: {#5e3d8fe9 .cell execution_count=3}\n``` {.python .cell-code}\n# analyze/core.py\n\n# Load and prepare swing data\nload_golfer_data(csv_path, golfer, data_dir, back_frames, down_frames, day_filter)\n\n# Build SwingData objects from dataframe\nbuild_swing_items(df)  # → List[SwingData]\n\n# Find most representative swing via directed Hausdorff distance\nresolve_group_by_score(items, score_range)  # → filtered SwingData pool\n\n# SPM comparison — per-metric t-tests across time-normalized phases\nspm_compare(group_a, group_b, metrics)  # → significance maps\n```\n:::\n\n\n::: {#8910eca8 .cell execution_count=4}\n``` {.python .cell-code}\n# analyze/plots.py\n\n# Main rendering function\nrender_analysis_figure(\n    src_items,        # Source swing group\n    tgt_items,        # Target swing group\n    phases,           # [\"backswing\", \"downswing\"]\n    metrics,          # Which metrics to plot\n    config            # PlotConfig (colors, sizes, etc.)\n)  # → matplotlib Figure\n```\n:::\n\n\n## Streamlit Dashboard\n\n`analyze/new_dashboard.py` provides an interactive UI for:\n\n- Selecting golfer and day\n- Choosing swing phases and metrics\n- Comparing swing groups visually\n- Viewing AI-generated analysis (via Gemini)\n\n```bash\nstreamlit run analyze/new_dashboard.py\n```\n\n",
    "supporting": [
      "analyze_files"
    ],
    "filters": [],
    "includes": {}
  }
}